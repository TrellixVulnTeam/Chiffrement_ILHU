{"ast":null,"code":"import _asyncToGenerator from \"/home/alex/Bureau/Chiffrement/Chiffrement/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { MessageService } from '../services/message.service';\nimport { Client } from '../Modèle/Client';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../Mod\\u00E8le/Client\";\nimport * as i2 from \"ngx-socket-io\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction TchatComponent_option_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"option\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function TchatComponent_option_11_Template_option_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.destinataire = $event;\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const client_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.destinataire);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(client_r3.name);\n  }\n}\n\nfunction TchatComponent_p_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", message_r6, \" \");\n  }\n}\n\nfunction TchatComponent_li_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵelementStart(1, \"a\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const client_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(client_r7.name);\n  }\n}\n\nexport class TchatComponent {\n  constructor(client, socket, route) {\n    this.client = client;\n    this.socket = socket;\n    this.route = route;\n    this.messages = [];\n    this.message = \"\";\n    this.destinataire = \"\";\n    this.name = \"\";\n    this.id = \"\";\n    this.clients = [];\n    this.bob = new Client();\n    this.messageService = new MessageService(socket);\n    var nom = this.route.queryParams.subscribe(params => {\n      this.client.age = params.age;\n      this.client.setName(params.username);\n    });\n    this.messageService.createClient(this.client);\n    this.clients.push(this.client);\n    this.getReceiveInformation();\n    this.getNomberConnected();\n  }\n\n  getNomberConnected() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      while (true) {\n        _this.socket.emit('NumberClient');\n\n        yield new Promise(r => setTimeout(r, 2000));\n      }\n    })();\n  }\n\n  getReceiveInformation() {\n    this.getServerMessage();\n    this.getNumberUser();\n  }\n\n  getServerMessage() {\n    this.socket.on('client', data => {\n      if (data.id_envoyeur != this.client.id) this.messages.push(data.message);\n    });\n  }\n\n  getNumberUser() {\n    let nb = 0;\n    this.socket.on('clients', data => {\n      console.log(data);\n\n      for (let i = 0; i < data.length; i++) {\n        var client = new Client();\n        client.setName(data[i].client.name);\n        client.setAge(data[i].client.age);\n        client.setSocket(data[i].id_socket);\n\n        if (!this.clientAlreadyExist(client)) {\n          this.clients.push(client);\n        }\n      }\n    });\n    return nb;\n  }\n\n  clientAlreadyExist(client) {\n    for (let i = 0; i < this.clients.length; i++) {\n      if (this.clients[i].getName() == client.getName() && this.clients[i].getAge() == client.getAge()) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  onSubmit() {\n    console.log(\"Destinataire choisi : \" + this.destinataire);\n    this.messages.push(this.message);\n    this.sendMessageTo(\"SPCekpse0f\", \"Bonjour Bob\"); //this.broadcastMessage( this.client.id, this.message);\n\n    this.message = \"\";\n  }\n\n  sendMessageTo(destinataire, message) {\n    this.messageService.sendMessageTo(this.client.id, destinataire, message);\n  }\n\n  broadcastMessage(idclient, message) {\n    this.messageService.broadCastMessage(idclient, message);\n  }\n\n  getClient() {\n    return this.client;\n  }\n\n  ngOnInit() {}\n\n}\n\nTchatComponent.ɵfac = function TchatComponent_Factory(t) {\n  return new (t || TchatComponent)(i0.ɵɵdirectiveInject(i1.Client), i0.ɵɵdirectiveInject(i2.Socket), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n};\n\nTchatComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TchatComponent,\n  selectors: [[\"app-tchat\"]],\n  inputs: {\n    messages: \"messages\",\n    message: \"message\",\n    destinataire: \"destinataire\",\n    name: \"name\",\n    id: \"id\"\n  },\n  decls: 27,\n  vars: 7,\n  consts: [[1, \"list-group-item\"], [\"for\", \"destinataire\"], [\"name\", \"destinataire\", \"id\", \"dest_select\"], [3, \"ngModel\", \"ngModelChange\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"cadre\"], [\"id\", \"conversation\", \"id\", \"messageRecu\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"text\", \"name\", \"newMessage\", 2, \"width\", \"100%\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"sendMessage\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngModel\", \"ngModelChange\"], [\"id\", \"conversation\", \"id\", \"messageRecu\"], [\"href\", \"#\"]],\n  template: function TchatComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"li\", 0);\n      i0.ɵɵelementStart(1, \"fieldset\");\n      i0.ɵɵelementStart(2, \"legend\");\n      i0.ɵɵtext(3, \"TChat\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"p\");\n      i0.ɵɵtext(5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"p\");\n      i0.ɵɵtext(7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"label\", 1);\n      i0.ɵɵtext(9, \" Select Destinataire \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"select\", 2);\n      i0.ɵɵtemplate(11, TchatComponent_option_11_Template, 2, 2, \"option\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"p\");\n      i0.ɵɵtext(13);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"fieldset\", 4);\n      i0.ɵɵelementStart(15, \"p\");\n      i0.ɵɵtext(16, \" Message : \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, TchatComponent_p_17_Template, 2, 1, \"p\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"input\", 6);\n      i0.ɵɵlistener(\"ngModelChange\", function TchatComponent_Template_input_ngModelChange_18_listener($event) {\n        return ctx.message = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(19, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function TchatComponent_Template_button_click_19_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵtext(20, \"Send message\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"fieldset\");\n      i0.ɵɵelementStart(22, \"legend\");\n      i0.ɵɵtext(23, \"Personnes connect\\u00E9s \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"ol\");\n      i0.ɵɵtemplate(25, TchatComponent_li_25_Template, 3, 1, \"li\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(26, \"router-outlet\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\" Bonjour : \", ctx.getClient().name, \" \");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" Identifiant : \", ctx.getClient().id, \" \");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.clients);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" Age : \", ctx.getClient().age, \" \");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngModel\", ctx.message);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngForOf\", ctx.clients);\n    }\n  },\n  directives: [i4.NgForOf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel, i3.RouterOutlet, i5.NgSelectOption, i5.ɵNgSelectMultipleOption],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0Y2hhdC5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"sources":["/home/alex/Bureau/Chiffrement/Chiffrement/frontend/src/app/tchat/tchat.component.ts"],"names":["MessageService","Client","i0","i1","i2","i3","i4","i5","TchatComponent_option_11_Template","rf","ctx","_r5","ɵɵgetCurrentView","ɵɵelementStart","ɵɵlistener","TchatComponent_option_11_Template_option_ngModelChange_0_listener","$event","ɵɵrestoreView","ctx_r4","ɵɵnextContext","destinataire","ɵɵtext","ɵɵelementEnd","client_r3","$implicit","ctx_r0","ɵɵproperty","ɵɵadvance","ɵɵtextInterpolate","name","TchatComponent_p_17_Template","message_r6","ɵɵtextInterpolate1","TchatComponent_li_25_Template","client_r7","TchatComponent","constructor","client","socket","route","messages","message","id","clients","bob","messageService","nom","queryParams","subscribe","params","age","setName","username","createClient","push","getReceiveInformation","getNomberConnected","emit","Promise","r","setTimeout","getServerMessage","getNumberUser","on","data","id_envoyeur","nb","console","log","i","length","setAge","setSocket","id_socket","clientAlreadyExist","getName","getAge","onSubmit","sendMessageTo","broadcastMessage","idclient","broadCastMessage","getClient","ngOnInit","ɵfac","TchatComponent_Factory","t","ɵɵdirectiveInject","Socket","ActivatedRoute","ɵcmp","ɵɵdefineComponent","type","selectors","inputs","decls","vars","consts","template","TchatComponent_Template","ɵɵtemplate","TchatComponent_Template_input_ngModelChange_18_listener","TchatComponent_Template_button_click_19_listener","ɵɵelement","directives","NgForOf","DefaultValueAccessor","NgControlStatus","NgModel","RouterOutlet","NgSelectOption","ɵNgSelectMultipleOption","styles"],"mappings":"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","sourcesContent":["import { MessageService } from '../services/message.service';\nimport { Client } from '../Modèle/Client';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../Mod\\u00E8le/Client\";\nimport * as i2 from \"ngx-socket-io\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction TchatComponent_option_11_Template(rf, ctx) { if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"option\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function TchatComponent_option_11_Template_option_ngModelChange_0_listener($event) { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.destinataire = $event; });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const client_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.destinataire);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(client_r3.name);\n} }\nfunction TchatComponent_p_17_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const message_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", message_r6, \" \");\n} }\nfunction TchatComponent_li_25_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵelementStart(1, \"a\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const client_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(client_r7.name);\n} }\nexport class TchatComponent {\n    constructor(client, socket, route) {\n        this.client = client;\n        this.socket = socket;\n        this.route = route;\n        this.messages = [];\n        this.message = \"\";\n        this.destinataire = \"\";\n        this.name = \"\";\n        this.id = \"\";\n        this.clients = [];\n        this.bob = new Client();\n        this.messageService = new MessageService(socket);\n        var nom = this.route.queryParams.subscribe(params => {\n            this.client.age = params.age;\n            this.client.setName(params.username);\n        });\n        this.messageService.createClient(this.client);\n        this.clients.push(this.client);\n        this.getReceiveInformation();\n        this.getNomberConnected();\n    }\n    async getNomberConnected() {\n        while (true) {\n            this.socket.emit('NumberClient');\n            await new Promise(r => setTimeout(r, 2000));\n        }\n    }\n    getReceiveInformation() {\n        this.getServerMessage();\n        this.getNumberUser();\n    }\n    getServerMessage() {\n        this.socket.on('client', (data) => {\n            if (data.id_envoyeur != this.client.id)\n                this.messages.push(data.message);\n        });\n    }\n    getNumberUser() {\n        let nb = 0;\n        this.socket.on('clients', (data) => {\n            console.log(data);\n            for (let i = 0; i < data.length; i++) {\n                var client = new Client();\n                client.setName(data[i].client.name);\n                client.setAge(data[i].client.age);\n                client.setSocket(data[i].id_socket);\n                if (!this.clientAlreadyExist(client)) {\n                    this.clients.push(client);\n                }\n            }\n        });\n        return nb;\n    }\n    clientAlreadyExist(client) {\n        for (let i = 0; i < this.clients.length; i++) {\n            if (this.clients[i].getName() == client.getName() && this.clients[i].getAge() == client.getAge()) {\n                return true;\n            }\n        }\n        return false;\n    }\n    onSubmit() {\n        console.log(\"Destinataire choisi : \" + this.destinataire);\n        this.messages.push(this.message);\n        this.sendMessageTo(\"SPCekpse0f\", \"Bonjour Bob\");\n        //this.broadcastMessage( this.client.id, this.message);\n        this.message = \"\";\n    }\n    sendMessageTo(destinataire, message) {\n        this.messageService.sendMessageTo(this.client.id, destinataire, message);\n    }\n    broadcastMessage(idclient, message) {\n        this.messageService.broadCastMessage(idclient, message);\n    }\n    getClient() {\n        return this.client;\n    }\n    ngOnInit() {\n    }\n}\nTchatComponent.ɵfac = function TchatComponent_Factory(t) { return new (t || TchatComponent)(i0.ɵɵdirectiveInject(i1.Client), i0.ɵɵdirectiveInject(i2.Socket), i0.ɵɵdirectiveInject(i3.ActivatedRoute)); };\nTchatComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TchatComponent, selectors: [[\"app-tchat\"]], inputs: { messages: \"messages\", message: \"message\", destinataire: \"destinataire\", name: \"name\", id: \"id\" }, decls: 27, vars: 7, consts: [[1, \"list-group-item\"], [\"for\", \"destinataire\"], [\"name\", \"destinataire\", \"id\", \"dest_select\"], [3, \"ngModel\", \"ngModelChange\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"cadre\"], [\"id\", \"conversation\", \"id\", \"messageRecu\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"text\", \"name\", \"newMessage\", 2, \"width\", \"100%\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"sendMessage\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngModel\", \"ngModelChange\"], [\"id\", \"conversation\", \"id\", \"messageRecu\"], [\"href\", \"#\"]], template: function TchatComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"li\", 0);\n        i0.ɵɵelementStart(1, \"fieldset\");\n        i0.ɵɵelementStart(2, \"legend\");\n        i0.ɵɵtext(3, \"TChat\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"p\");\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"p\");\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"label\", 1);\n        i0.ɵɵtext(9, \" Select Destinataire \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"select\", 2);\n        i0.ɵɵtemplate(11, TchatComponent_option_11_Template, 2, 2, \"option\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"p\");\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"fieldset\", 4);\n        i0.ɵɵelementStart(15, \"p\");\n        i0.ɵɵtext(16, \" Message : \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, TchatComponent_p_17_Template, 2, 1, \"p\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function TchatComponent_Template_input_ngModelChange_18_listener($event) { return ctx.message = $event; });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function TchatComponent_Template_button_click_19_listener() { return ctx.onSubmit(); });\n        i0.ɵɵtext(20, \"Send message\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"fieldset\");\n        i0.ɵɵelementStart(22, \"legend\");\n        i0.ɵɵtext(23, \"Personnes connect\\u00E9s \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"ol\");\n        i0.ɵɵtemplate(25, TchatComponent_li_25_Template, 3, 1, \"li\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(26, \"router-outlet\");\n    } if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" Bonjour : \", ctx.getClient().name, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" Identifiant : \", ctx.getClient().id, \" \");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.clients);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" Age : \", ctx.getClient().age, \" \");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.message);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.clients);\n    } }, directives: [i4.NgForOf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel, i3.RouterOutlet, i5.NgSelectOption, i5.ɵNgSelectMultipleOption], styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0Y2hhdC5jb21wb25lbnQuY3NzIn0= */\"] });\n"]},"metadata":{},"sourceType":"module"}